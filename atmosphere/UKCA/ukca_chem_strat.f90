! *****************************COPYRIGHT*******************************
! (c) [University of Cambridge] [2008]. All rights reserved.
! This routine has been licensed to the Met Office for use and
! distribution under the UKCA collaboration agreement, subject
! to the terms and conditions set out therein.
! [Met Office Ref SC138]
! *****************************COPYRIGHT*******************************
!
!  Description:
!    Module providing UKCA with inputs describing chemistry
!
!  Part of the UKCA model, a community model supported by the
!  Met Office and NCAS, with components provided initially
!  by The University of Cambridge, University of Leeds and
!  The Met. Office.  See www.ukca.ac.uk
!
!
! Code Owner: See Unified Model Code Owners HTML page
! This file belongs in section: UKCA
!
!  Code Description:
!   Language:  FORTRAN 90
!   This code is written to UMDP3 v6 programming standards.
!
! ----------------------------------------------------------------------
!
MODULE UKCA_CHEM_STRAT

USE UKCA_CHEM_DEFS_MOD, ONLY: chch_t, ratb_t, rath_t, ratj_t, ratt_t,  &
                              chch_defs, ratb_defs, rath_defs,         &
                              ratj_defs, ratt_defs, depvel_defs,       &
                              henry_defs
USE ukca_option_mod,    ONLY: L_ukca_strat, L_ukca_het_psc,            &
                              L_ukca_achem, jpspec, jpbk, jptk, jphk,  &
                              jppj, jpdd, jpdw
USE ASAD_MOD,           ONLY: jddepc, jddept
USE Control_Max_Sizes
IMPLICIT NONE
PRIVATE

!#include "cmaxsize.h"

! Standard stratospheric chemistry with optional: aerosol chemistry
! =================================================================

TYPE(CHCH_T), DIMENSION(:), ALLOCATABLE, PUBLIC :: chch_defs_strat
TYPE(RATB_T), DIMENSION(:), ALLOCATABLE, PUBLIC :: ratb_defs_strat
TYPE(RATT_T), DIMENSION(:), ALLOCATABLE, PUBLIC :: ratt_defs_strat
TYPE(RATJ_T), DIMENSION(:), ALLOCATABLE, PUBLIC :: ratj_defs_strat
TYPE(RATH_T), DIMENSION(:), ALLOCATABLE, PUBLIC :: rath_defs_strat
REAL,     DIMENSION(:,:,:), ALLOCATABLE, PUBLIC :: depvel_defs_strat
REAL,     DIMENSION(:,:),   ALLOCATABLE, PUBLIC :: henry_defs_strat

! No of heterogenous processes
INTEGER, PARAMETER, PUBLIC :: nhet_strat = 5           ! Stratospheric chemistry
INTEGER, PARAMETER, PUBLIC :: nhet_aer   = 3           ! Aqueous phase

! No of dry deposited species
INTEGER, PARAMETER, PUBLIC :: ndry_strat    = 15       ! Stratospheric chemistry
INTEGER, PARAMETER, PUBLIC :: ndry_aer      = 1        ! Aerosol chemistry

! No of wet deposited species
INTEGER, PARAMETER, PUBLIC :: nwet_strat    = 15       ! Stratospheric chemistry
INTEGER, PARAMETER, PUBLIC :: nwet_aer      = 2        ! Aerosol chemistry additions



! 2) Standard Stratospheric Chemistry
! ===================================

TYPE(CHCH_T), DIMENSION( 41) :: chch_defs_strat1=(/ &
chch_t(  1,'O(3P)     ',  1,'TR        ','Ox        ',  0,  0,  0),  &
chch_t(  1,'O(1D)     ',  1,'SS        ','Ox        ',  0,  0,  0),  &
chch_t(  2,'O3        ',  1,'TR        ','Ox        ',  1,  0,  0),  &
chch_t(  3,'N         ',  1,'TR        ','NOx       ',  0,  0,  0),  &
chch_t(  4,'NO        ',  1,'TR        ','NOx       ',  1,  0,  0),  &
chch_t(  5,'NO3       ',  1,'TR        ','NOx       ',  1,  1,  0),  &
chch_t(  6,'NO2       ',  1,'TR        ','NOx       ',  1,  0,  1),  &
chch_t(  7,'N2O5      ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t(  8,'HO2NO2    ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t(  9,'HONO2     ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 10,'H2O2      ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 11,'CH4       ',  1,'TR        ','          ',  0,  0,  2),  &
chch_t( 12,'CO        ',  1,'TR        ','          ',  1,  0,  3),  &
chch_t( 12,'CO2       ',  1,'CT        ','          ',  0,  0,  0),  &
chch_t( 13,'HCHO      ',  1,'TR        ','          ',  1,  1,  4),  &
chch_t( 14,'H2O       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 15,'MeOO      ',  1,'TR        ','          ',  0,  1,  0),  &
chch_t( 16,'MeOOH     ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 17,'H2        ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 17,'O2        ',  1,'CT        ','          ',  0,  0,  0),  &
chch_t( 17,'N2        ',  1,'CT        ','          ',  0,  0,  0),  &
chch_t( 18,'H         ',  1,'TR        ','HOx       ',  0,  0,  0),  &
chch_t( 19,'OH        ',  1,'TR        ','HOx       ',  0,  0,  0),  &
chch_t( 20,'HO2       ',  1,'TR        ','HOx       ',  0,  1,  0),  &
chch_t( 21,'Cl        ',  1,'TR        ','Clx       ',  0,  0,  0),  &
chch_t( 22,'Cl2O2     ',  1,'TR        ','Clx       ',  0,  0,  0),  &
chch_t( 23,'ClO       ',  1,'TR        ','Clx       ',  0,  0,  0),  &
chch_t( 24,'OClO      ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 25,'Br        ',  1,'TR        ','Brx       ',  0,  0,  0),  &
chch_t( 26,'BrO       ',  1,'TR        ','Brx       ',  0,  0,  0),  &
chch_t( 27,'BrCl      ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 28,'BrONO2    ',  1,'TR        ','          ',  0,  1,  0),  &
chch_t( 29,'N2O       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 30,'HCl       ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 31,'HOCl      ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 32,'HBr       ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 33,'HOBr      ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 34,'ClONO2    ',  1,'TR        ','          ',  0,  1,  0),  &
chch_t( 35,'CFCl3     ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 36,'CF2Cl2    ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 37,'MeBr      ',  1,'TR        ','          ',  0,  0,  0)   &
 /)

TYPE(CHCH_T), DIMENSION( 49) :: chch_defs_strat_aer=(/               &
chch_t(  1,'O(3P)     ',  1,'TR        ','Ox        ',  0,  0,  0),  &
chch_t(  1,'O(1D)     ',  1,'SS        ','Ox        ',  0,  0,  0),  &
chch_t(  2,'O3        ',  1,'TR        ','Ox        ',  1,  1,  0),  &
chch_t(  3,'N         ',  1,'TR        ','NOx       ',  0,  0,  0),  &
chch_t(  4,'NO        ',  1,'TR        ','NOx       ',  1,  0,  0),  &
chch_t(  5,'NO3       ',  1,'TR        ','NOx       ',  1,  1,  0),  &
chch_t(  6,'NO2       ',  1,'TR        ','NOx       ',  1,  0,  1),  &
chch_t(  7,'N2O5      ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t(  8,'HO2NO2    ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t(  9,'HONO2     ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 10,'H2O2      ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 11,'CH4       ',  1,'TR        ','          ',  0,  0,  2),  &
chch_t( 12,'CO        ',  1,'TR        ','          ',  1,  0,  3),  &
chch_t( 12,'CO2       ',  1,'CT        ','          ',  0,  0,  0),  &
chch_t( 13,'HCHO      ',  1,'TR        ','          ',  1,  1,  4),  &
chch_t( 14,'H2O       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 15,'MeOO      ',  1,'TR        ','          ',  0,  1,  0),  &
chch_t( 16,'MeOOH     ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 17,'H2        ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 17,'O2        ',  1,'CT        ','          ',  0,  0,  0),  &
chch_t( 17,'N2        ',  1,'CT        ','          ',  0,  0,  0),  &
chch_t( 18,'H         ',  1,'TR        ','HOx       ',  0,  0,  0),  &
chch_t( 19,'OH        ',  1,'TR        ','HOx       ',  0,  0,  0),  &
chch_t( 20,'HO2       ',  1,'TR        ','HOx       ',  0,  1,  0),  &
chch_t( 21,'Cl        ',  1,'TR        ','Clx       ',  0,  0,  0),  &
chch_t( 22,'Cl2O2     ',  1,'TR        ','Clx       ',  0,  0,  0),  &
chch_t( 23,'ClO       ',  1,'TR        ','Clx       ',  0,  0,  0),  &
chch_t( 24,'OClO      ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 25,'Br        ',  1,'TR        ','Brx       ',  0,  0,  0),  &
chch_t( 26,'BrO       ',  1,'TR        ','Brx       ',  0,  0,  0),  &
chch_t( 27,'BrCl      ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 28,'BrONO2    ',  1,'TR        ','          ',  0,  1,  0),  &
chch_t( 29,'N2O       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 30,'HCl       ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 31,'HOCl      ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 32,'HBr       ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 33,'HOBr      ',  1,'TR        ','          ',  1,  1,  0),  &
chch_t( 34,'ClONO2    ',  1,'TR        ','          ',  0,  1,  0),  &
chch_t( 35,'CFCl3     ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 36,'CF2Cl2    ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 37,'MeBr      ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 38,'DMS       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 39,'SO2       ',  1,'TR        ','          ',  1,  1,  1),  &
chch_t( 40,'H2SO4     ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 41,'MSA       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 42,'CS2       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 43,'COS       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 44,'H2S       ',  1,'TR        ','          ',  0,  0,  0),  &
chch_t( 45,'SO3       ',  1,'TR        ','          ',  0,  0,  0)   &
 /)
 
 
TYPE(RATB_T), DIMENSION( 29), PARAMETER :: ratb_defs_as=(/                          &
ratb_t('Br        ','Cl2O2     ','BrCl      ','Cl        ','O2        ', &
'          ',  3.00E-12,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Br        ','O3        ','BrO       ','O2        ','          ', &
'          ',  1.70E-11,  0.00,    800.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Br        ','OClO      ','BrO       ','ClO       ','          ', &
'          ',  2.70E-11,  0.00,   1300.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Br        ','HCHO      ','HBr       ','CO        ','HO2       ', &
'          ',  1.70E-11,  0.00,    800.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('Br        ','HO2       ','HBr       ','O2        ','          ', &
'          ',  1.40E-11,  0.00,    590.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('BrO       ','BrO       ','Br        ','Br        ','O2        ', &
'          ',  2.40E-12,  0.00,    -40.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003,
ratb_t('BrO       ','ClO       ','Br        ','OClO      ','          ', &
'          ',  1.60E-12,  0.00,   -430.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('BrO       ','ClO       ','Br        ','Cl        ','O2        ', &
'          ',  2.90E-12,  0.00,   -220.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('BrO       ','ClO       ','BrCl      ','O2        ','          ', &
'          ',  5.80E-13,  0.00,   -170.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('BrO       ','NO        ','Br        ','NO2       ','          ', &
'          ',  8.70E-12,  0.00,   -260.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('BrO       ','HO2       ','HOBr      ','O2        ','          ', &
'          ',  3.30E-12,  0.00,   -540.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003,
ratb_t('BrO       ','HO2       ','HBr       ','O3        ','          ', &
'          ',  7.00E-14,  0.00,   -540.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003,
ratb_t('BrO       ','OH        ','Br        ','HO2       ','          ', &
'          ',  7.50E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','CH4       ','HCl       ','MeOO      ','          ', &
'          ',  6.60E-12,  0.00,   1240.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','Cl2O2     ','Cl        ','Cl        ','Cl        ', &
'          ',  1.00E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','ClONO2    ','Cl        ','Cl        ','NO3       ', &
'          ',  6.50E-12,  0.00,   -135.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','H2        ','HCl       ','H         ','          ', &
'          ',  3.90E-11,  0.00,   2310.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','H2O2      ','HCl       ','HO2       ','          ', &
'          ',  1.10E-11,  0.00,    980.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','HCHO      ','HCl       ','CO        ','HO2       ', &
'          ',  8.20E-11,  0.00,     34.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','HO2       ','HCl       ','O2        ','          ', &
'          ',  1.80E-11,  0.00,   -170.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','HO2       ','ClO       ','OH        ','          ', &
'          ',  4.10E-11,  0.00,    450.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','HOCl      ','Cl        ','Cl        ','OH        ', &
'          ',  2.50E-12,  0.00,    130.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('Cl        ','NO3       ','ClO       ','NO2       ','          ', &
'          ',  2.40E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','O3        ','ClO       ','O2        ','          ', &
'          ',  2.90E-11,  0.00,    260.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('Cl        ','OClO      ','ClO       ','ClO       ','          ', &
'          ',  3.20E-11,  0.00,   -170.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('ClO       ','ClO       ','Cl        ','Cl        ','O2        ', &
'          ',  3.00E-11,  0.00,   2450.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('ClO       ','ClO       ','Cl        ','Cl        ','O2        ', &
'          ',  1.00E-12,  0.00,   1590.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('ClO       ','ClO       ','Cl        ','OClO      ','          ', &
'          ',  3.50E-13,  0.00,   1370.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('ClO       ','HO2       ','HOCl      ','O2        ','          ', &
'          ',  4.60E-13,  0.00,   -710.00, 0.000, 0.000, 0.000, 0.000)   & !   C       
  /)



TYPE(RATB_T), DIMENSION( 28), PARAMETER :: ratb_defs_bs=(/                          &
ratb_t('ClO       ','HO2       ','HCl       ','O3        ','          ', &
'          ',  0.00E+00,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   C       
ratb_t('ClO       ','MeOO      ','Cl        ','HCHO      ','HO2       ', &
'          ',  3.30E-12,  0.00,    115.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('ClO       ','NO        ','Cl        ','NO2       ','          ', &
'          ',  6.20E-12,  0.00,   -295.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('ClO       ','NO3       ','Cl        ','O2        ','NO2       ', &
'          ',  4.60E-13,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   D       
ratb_t('ClO       ','NO3       ','OClO      ','NO2       ','          ', &
'          ',  0.00E+00,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   D       
ratb_t('HO2       ','HO2       ','H2O2      ','O2        ','          ', &
'          ',  2.20E-13,  0.00,   -600.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('HO2       ','MeOO      ','O2        ','MeOOH     ','          ', &
'          ',  3.80E-13,  0.00,   -780.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('HO2       ','NO        ','OH        ','NO2       ','          ', &
'          ',  3.50E-12,  0.00,   -250.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('HO2       ','NO3       ','O2        ','HONO2     ','          ', &
'          ',  2.15E-12,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   E       
ratb_t('HO2       ','NO3       ','OH        ','NO2       ','O2        ', &
'          ',  2.15E-12,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   E       
ratb_t('HO2       ','O3        ','OH        ','O2        ','O2        ', &
'          ',  2.03E-16,  4.57,   -693.00, 0.000, 0.000, 0.000, 0.000) , & !   F       
ratb_t('MeOO      ','MeOO      ','HCHO      ','HO2       ','O2        ', &
'          ',  9.50E-14,  0.00,   -390.00, 2.000, 2.000, 1.000, 0.000) , & !   JPL2003 
ratb_t('MeOO      ','NO        ','HCHO      ','HO2       ','NO2       ', &
'          ',  2.95E-12,  0.00,   -285.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('NO        ','NO3       ','NO2       ','NO2       ','          ', &
'          ',  1.80E-11,  0.00,   -110.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('NO        ','O3        ','NO2       ','O2        ','          ', &
'          ',  1.40E-12,  0.00,   1310.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('NO2       ','NO3       ','NO        ','NO2       ','O2        ', &
'          ',  4.50E-14,  0.00,   1260.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('NO2       ','O3        ','NO3       ','O2        ','          ', &
'          ',  1.40E-13,  0.00,   2470.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('NO3       ','Br        ','BrO       ','NO2       ','          ', &
'          ',  1.60E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('NO3       ','HCHO      ','HONO2     ','CO        ','HO2       ', &
'          ',  5.60E-16,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','BrO       ','O2        ','Br        ','          ', &
'          ',  1.90E-11,  0.00,   -230.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','ClO       ','Cl        ','O2        ','          ', &
'          ',  3.80E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','H2        ','OH        ','H         ','          ', &
'          ',  9.00E-18,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','H2O2      ','OH        ','HO2       ','          ', &
'          ',  1.40E-12,  0.00,   2000.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','HBr       ','OH        ','Br        ','          ', &
'          ',  5.80E-12,  0.00,   1500.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('O(3P)     ','HCHO      ','OH        ','CO        ','HO2       ', &
'          ',  3.40E-11,  0.00,   1600.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','HCl       ','OH        ','Cl        ','          ', &
'          ',  1.00E-11,  0.00,   3300.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('O(3P)     ','HO2       ','OH        ','O2        ','          ', &
'          ',  2.70E-11,  0.00,   -224.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','HOCl      ','OH        ','ClO       ','          ', &
'          ',  1.70E-13,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000)   & !           
  /)


TYPE(RATB_T), DIMENSION( 28), PARAMETER :: ratb_defs_cs=(/                          &
ratb_t('O(3P)     ','NO2       ','O2        ','NO        ','          ', &
'          ',  5.60E-12,  0.00,   -180.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','NO3       ','O2        ','NO2       ','          ', &
'          ',  1.70E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','O3        ','O2        ','O2        ','          ', &
'          ',  8.00E-12,  0.00,   2060.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','OClO      ','O2        ','ClO       ','          ', &
'          ',  2.40E-12,  0.00,    960.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(3P)     ','OH        ','O2        ','H         ','          ', &
'          ',  2.40E-11,  0.00,   -110.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(1D)     ','HBr       ','HBr       ','O(3P)     ','          ', &
'          ',  3.00E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   G       
ratb_t('O(1D)     ','HBr       ','OH        ','Br        ','          ', &
'          ',  1.20E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   G       
ratb_t('O(1D)     ','CH4       ','OH        ','MeOO      ','          ', &
'          ',  1.35E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   H       
ratb_t('O(1D)     ','CH4       ','HCHO      ','H2        ','          ', &
'          ',  1.50E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   H       
ratb_t('O(1D)     ','CO2       ','O(3P)     ','CO2       ','          ', &
'          ',  7.40E-11,  0.00,   -120.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('O(1D)     ','H2        ','OH        ','H         ','          ', &
'          ',  1.10E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(1D)     ','H2O       ','OH        ','OH        ','          ', &
'          ',  2.20E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(1D)     ','HCl       ','O(3P)     ','HCl       ','          ', &
'          ',  1.35E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   I       
ratb_t('O(1D)     ','HCl       ','H         ','ClO       ','          ', &
'          ',  3.60E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   I       
ratb_t('O(1D)     ','HCl       ','OH        ','Cl        ','          ', &
'          ',  1.01E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   I       
ratb_t('O(1D)     ','N2        ','O(3P)     ','N2        ','          ', &
'          ',  1.80E-11,  0.00,   -110.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(1D)     ','N2O       ','N2        ','O2        ','          ', &
'          ',  4.90E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('O(1D)     ','N2O       ','NO        ','NO        ','          ', &
'          ',  6.70E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('O(1D)     ','O2        ','O(3P)     ','O2        ','          ', &
'          ',  3.20E-11,  0.00,    -70.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('O(1D)     ','O3        ','O2        ','O(3P)     ','O(3P)     ', &
'          ',  1.20E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   J       
ratb_t('O(1D)     ','O3        ','O2        ','O2        ','          ', &
'          ',  1.20E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   J       
ratb_t('OClO      ','NO        ','NO2       ','ClO       ','          ', &
'          ',  3.40E-13,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','CH4       ','H2O       ','MeOO      ','          ', &
'          ',  1.85E-12,  0.00,   1690.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','CO        ','H         ','CO2       ','          ', &
'          ',  1.30E-13,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   K       
ratb_t('OH        ','ClO       ','HO2       ','Cl        ','          ', &
'          ',  7.40E-12,  0.00,   -270.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('OH        ','ClO       ','HCl       ','O2        ','          ', &
'          ',  6.00E-13,  0.00,   -230.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('OH        ','H2        ','H2O       ','H         ','          ', &
'          ',  7.70E-12,  0.00,   2100.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','H2O2      ','H2O       ','HO2       ','          ', &
'          ',  2.90E-12,  0.00,    160.00, 0.000, 0.000, 0.000, 0.000)   & !           
  /)

TYPE(RATB_T), DIMENSION( 28), PARAMETER :: ratb_defs_ds=(/                          &
ratb_t('OH        ','HBr       ','H2O       ','Br        ','          ', &
'          ',  1.10E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','HCHO      ','H2O       ','CO        ','HO2       ', &
'          ',  8.20E-12,  0.00,    -40.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','HCl       ','H2O       ','Cl        ','          ', &
'          ',  1.80E-12,  0.00,    240.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','HO2       ','H2O       ','O2        ','          ', &
'          ',  4.80E-11,  0.00,   -250.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','HOCl      ','ClO       ','H2O       ','          ', &
'          ',  3.00E-12,  0.00,    500.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('OH        ','HONO2     ','H2O       ','NO3       ','          ', &
'          ',  1.50E-13,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   L       
ratb_t('OH        ','MeOOH     ','H2O       ','MeOO      ','          ', &
'          ',  2.70E-12,  0.00,   -200.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','NO3       ','HO2       ','NO2       ','          ', &
'          ',  2.20E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003 
ratb_t('OH        ','O3        ','HO2       ','O2        ','          ', &
'          ',  1.70E-12,  0.00,    940.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','OClO      ','HOCl      ','O2        ','          ', &
'          ',  4.50E-13,  0.00,   -800.00, 0.000, 0.000, 0.000, 0.000) , & !           
ratb_t('OH        ','OH        ','H2O       ','O(3P)     ','          ', &
'          ',  4.20E-12,  0.00,    240.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003,
ratb_t('O(3P)     ','ClONO2    ','ClO       ','NO3       ','          ', &
'          ',  2.90E-12,  0.00,    800.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003,
ratb_t('OH        ','ClONO2    ','HOCl      ','NO3       ','          ', &
'          ',  1.20E-12,  0.00,    330.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003,
ratb_t('OH        ','HO2NO2    ','H2O       ','NO2       ','O2        ', &
'          ',  1.30E-12,  0.00,   -380.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003,
ratb_t('Cl        ','MeOOH     ','HCl       ','MeOO      ','          ', &
'          ',  5.70E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !   JPL2003,
ratb_t('CFCl3     ','O(1D)     ','Cl        ','Cl        ','ClO       ', &
'          ',  2.30E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('CF2Cl2    ','O(1D)     ','Cl        ','ClO       ','          ', &
'          ',  1.40E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('MeBr      ','OH        ','Br        ','H2O       ','          ', &
'          ',  2.35E-12,  0.00,   1300.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('MeBr      ','O(1D)     ','Br        ','OH        ','          ', &
'          ',  1.80E-10,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('MeBr      ','Cl        ','Br        ','HCl       ','          ', &
'          ',  1.70E-11,  0.00,   1080.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('N         ','O2        ','NO        ','O(3P)     ','          ', &
'          ',  1.50E-11,  0.00,   3600.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('N         ','NO        ','N2        ','O(3P)     ','          ', &
'          ',  2.10E-11,  0.00,   -100.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('N         ','NO2       ','N2O       ','O(3P)     ','          ', &
'          ',  5.80E-12,  0.00,   -220.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('H         ','O3        ','OH        ','O2        ','          ', &
'          ',  1.40E-10,  0.00,    470.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002  
ratb_t('H         ','HO2       ','OH        ','OH        ','          ', &
'          ',  5.59E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002 a
ratb_t('H         ','HO2       ','H2        ','O2        ','          ', &
'          ',  2.35E-11,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002 a
ratb_t('H         ','HO2       ','O(3P)     ','H2O       ','          ', &
'          ',  1.62E-12,  0.00,      0.00, 0.000, 0.000, 0.000, 0.000) , & !  JPL2002 a
ratb_t('H         ','NO2       ','OH        ','NO        ','          ', &
'          ',  4.00E-10,  0.00,    340.00, 0.000, 0.000, 0.000, 0.000) & !  JPL2002  
  /)

! aerosol chemistry
TYPE(RATB_T), DIMENSION(  12),PARAMETER :: ratb_defs_strat_aer=(/              & 
ratb_t('CS2      ','O(3P)    ','COS       ','SO2       ','CO        ',   &
'          ',3.20E-11,  0.00,    650.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('CS2     ','OH        ','COS       ','SO2       ','          ',   &
'          ',1.25E-16,  0.00,  -4550.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('DMS     ','O(3P)     ','SO2       ','          ','          ',   &
'          ',1.30E-11,  0.00,   -410.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('DMS     ','OH        ','SO2       ','          ','          ',   &
'          ',1.20E-11,  0.00,    260.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('DMS     ','OH        ','MSA       ','SO2       ','          ',   &
'          ',3.04E-12,  0.00,   -350.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('DMS     ','NO3       ','SO2       ','          ','          ',   &
'          ',1.90E-13,  0.00,   -500.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('H2S     ','O(3P)     ','OH        ','SO2       ','          ',   &
'          ',9.20E-12,  0.00,   1800.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('H2S     ','OH        ','SO2       ','H2O       ','          ',   &
'          ',6.00E-12,  0.00,     75.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('COS     ','O(3P)     ','CO        ','SO2       ','          ',   &
'          ',2.10E-11,  0.00,   2200.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('COS     ','OH        ','CO2       ','SO2       ','          ',   &
'          ',1.10E-13,  0.00,   1200.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('SO2     ','O3        ','SO3       ','          ','          ',   &
'          ',3.00E-12,  0.00,   7000.00, 0.000, 0.000, 0.000, 0.000) ,   &
ratb_t('SO3     ','H2O       ','H2SO4     ','H2O       ','          ',   &
'          ',8.50E-41,  0.00,  -6540.00, 0.000, 0.000, 0.000, 0.000)     &
  /)


TYPE(RATB_T), DIMENSION( 113), PARAMETER :: ratb_defs_strat1=(/          &
     ratb_defs_as, ratb_defs_bs, ratb_defs_cs, ratb_defs_ds              &
  /)

 
TYPE(RATH_T), DIMENSION(:), ALLOCATABLE :: rath_defs_strat_chem

TYPE(RATH_T), DIMENSION(nhet_strat) :: rath_defs_strat_psc=(/ &
rath_t('ClONO2    ','H2O       ','HOCl      ','HONO2     ','          ', &
'          ', 0.000, 0.000, 0.000, 0.000), &
rath_t('ClONO2    ','HCl       ','Cl        ','Cl        ','HONO2     ', &
'          ', 0.000, 0.000, 0.000, 0.000), &
rath_t('HOCl      ','HCl       ','Cl        ','Cl        ','H2O       ', &
'          ', 0.000, 0.000, 0.000, 0.000), &
rath_t('N2O5      ','H2O       ','HONO2     ','HONO2     ','          ', &
'          ', 0.000, 0.000, 0.000, 0.000), &
rath_t('N2O5      ','HCl       ','Cl        ','NO2       ','HONO2     ', &
'          ', 0.000, 0.000, 0.000, 0.000)  &
  /)

! aerosol chemistry, the 'NULLx' products identify the reactions in asad_hetero
TYPE(RATH_T), DIMENSION(nhet_aer) :: rath_defs_strat_aer=(/              &
rath_t('SO2       ','H2O2      ','NULL0     ','          ','          ', & !HSO3+H2O2(aq)
'          ', 0.000, 0.000, 0.000, 0.000),                               &
rath_t('SO2       ','O3        ','NULL1     ','          ','          ', & !HSO3+O3(aq)
'          ', 0.000, 0.000, 0.000, 0.000),                               &
rath_t('SO2       ','O3        ','NULL2     ','          ','          ', & !SO3+O3(aq)
'          ', 0.000, 0.000, 0.000, 0.000)                                &
  /)

! used if no Aerosol Chemistry included
TYPE(RATH_T), DIMENSION(   0) :: rath_defs_strat_null


! NOTE - updated/backdated products from PB: Cl2O2 -> 2xCl; OClO -> Cl 
  TYPE(RATJ_T), DIMENSION(  34) :: ratj_defs_strat1=(/ &
ratj_t('BrCl      ','PHOTON    ','Br        ','Cl        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jbrcl     ') ,  &
ratj_t('BrO       ','PHOTON    ','Br        ','O(3P)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jbro      ') ,  &
ratj_t('BrONO2    ','PHOTON    ','Br        ','NO3       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jbrna     ') ,  &
ratj_t('BrONO2    ','PHOTON    ','BrO       ','NO2       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jbrnb     ') ,  &
ratj_t('O2        ','PHOTON    ','O(3P)     ','O(3P)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jo2       ') ,  &
ratj_t('O2        ','PHOTON    ','O(3P)     ','O(1D)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jo2b      ') ,  &
ratj_t('O3        ','PHOTON    ','O2        ','O(3P)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jo3b      ') ,  &
ratj_t('O3        ','PHOTON    ','O2        ','O(1D)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jo3a      ') ,  &
ratj_t('OClO      ','PHOTON    ','O(3P)     ','ClO       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'joclo     ') ,  &
ratj_t('NO        ','PHOTON    ','N         ','O(3P)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jno       ') ,  &
ratj_t('NO2       ','PHOTON    ','NO        ','O(3P)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jno2      ') ,  &
ratj_t('NO3       ','PHOTON    ','NO        ','O2        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jno3a     ') ,  &
ratj_t('NO3       ','PHOTON    ','NO2       ','O(3P)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jno3b     ') ,  &
ratj_t('HOBr      ','PHOTON    ','OH        ','Br        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jhobr     ') ,  &
ratj_t('HONO2     ','PHOTON    ','NO2       ','OH        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jhono2    ') ,  &
ratj_t('HO2NO2    ','PHOTON    ','NO2       ','HO2       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jpna67    ') ,  &
ratj_t('HO2NO2    ','PHOTON    ','NO3       ','OH        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jpna33    ') ,  &
ratj_t('N2O       ','PHOTON    ','N2        ','O(1D)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jn2o      ') ,  &
ratj_t('N2O5      ','PHOTON    ','NO2       ','NO3       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jn2o5     ') ,  &
ratj_t('H2O       ','PHOTON    ','OH        ','H         ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jh2o      ') ,  &
ratj_t('H2O2      ','PHOTON    ','OH        ','OH        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jh2o2     ') ,  &
ratj_t('ClONO2    ','PHOTON    ','Cl        ','NO3       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jclna     ') ,  &
ratj_t('ClONO2    ','PHOTON    ','ClO       ','NO2       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jclnb     ') ,  &
ratj_t('HCl       ','PHOTON    ','H         ','Cl        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jhcl      ') ,  &
ratj_t('HOCl      ','PHOTON    ','OH        ','Cl        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jhocl     ') ,  &
ratj_t('Cl2O2     ','PHOTON    ','Cl        ','Cl        ','O2        ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jcl2o2    ') ,  &
ratj_t('HCHO      ','PHOTON    ','H         ','CO        ','HO2       ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jhchoa    ') ,  &
ratj_t('HCHO      ','PHOTON    ','H2        ','CO        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jhchob    ') ,  &
ratj_t('MeOOH     ','PHOTON    ','HCHO      ','HO2       ','OH        ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jmhp      ') ,  &
ratj_t('CFCl3     ','PHOTON    ','Cl        ','Cl        ','Cl        ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jcfcl3    ') ,  &
ratj_t('CF2Cl2    ','PHOTON    ','Cl        ','Cl        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jcfc2     ') ,  &
ratj_t('MeBr      ','PHOTON    ','Br        ','H         ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jmebr     ') ,  &
ratj_t('CH4       ','PHOTON    ','MeOO      ','H         ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jch4      ') ,  &
ratj_t('CO2       ','PHOTON    ','CO        ','O(3P)     ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jco2      ')  &
  /) 

TYPE(RATJ_T), DIMENSION(4) :: ratj_defs_strat_aer = (/                  &
ratj_t('CS2      ','PHOTON    ','COS        ','SO2       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jcs2      '),   &
ratj_t('COS      ','PHOTON    ','CO         ','SO2       ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jcos      '),   &
ratj_t('H2SO4    ','PHOTON    ','SO3        ','OH        ','          ', &
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jh2so4    '),   &
ratj_t('SO3      ','PHOTON    ','SO2        ','O(3P)     ','          ',&
     '          ',   0.0,   0.0,   0.0,   0.0, 100.0,'jso3      ')      &
  /)
   
TYPE(RATT_T), DIMENSION(  17) :: ratt_defs_strat1=(/ &
ratt_t('BrO       ','NO2       ','BrONO2    ','m         ', &
   327.0, 4.70E-31, -3.10,     0.0, 1.40E-11, -1.20,       0.0, 0.000, 0.000) , & !           
ratt_t('Cl2O2     ','m         ','ClO       ','ClO       ', &
     0.6, 1.00E-06,  1.00,  8000.0, 4.80E+15,  0.00,    8820.0, 0.000, 0.000) , & !           
ratt_t('ClO       ','ClO       ','Cl2O2     ','m         ', &
     0.6, 1.70E-32, -4.00,     0.0, 5.40E-12,  0.00,       0.0, 0.000, 0.000) , & !           
ratt_t('ClO       ','NO2       ','ClONO2    ','m         ', &
   430.0, 1.60E-31, -3.40,     0.0, 1.50E-11,  0.00,       0.0, 0.000, 0.000) , & !           
ratt_t('HO2       ','HO2       ','H2O2      ','O2        ', &
     0.0, 1.90E-33,  0.00,  -980.0, 0.00E+00,  0.00,       0.0, 0.000, 0.000) , & !   A       
ratt_t('HO2       ','NO2       ','HO2NO2    ','m         ', &
     0.6, 1.80E-31, -3.20,     0.0, 4.70E-12,  0.00,       0.0, 0.000, 0.000) , & !           
ratt_t('HO2NO2    ','m         ','HO2       ','NO2       ', &
     0.6, 4.10E-06,  0.00, 10650.0, 4.80E+15,  0.00,   11170.0, 0.000, 0.000) , & !           
ratt_t('N2O5      ','m         ','NO2       ','NO3       ', &
     0.3, 1.30E-03, -3.50, 11000.0, 9.70E+14,  0.10,   11080.0, 0.000, 0.000) , & !           
ratt_t('NO        ','NO        ','NO2       ','NO2       ', &
     0.0, 6.93E-40,  0.00,  -530.0, 0.00E+00,  0.00,       0.0, 0.000, 0.000) , & !   B       
ratt_t('NO2       ','NO3       ','N2O5      ','m         ', &
     0.3, 3.60E-30, -4.10,     0.0, 1.90E-12,  0.20,       0.0, 0.000, 0.000) , & !           
ratt_t('O(3P)     ','NO        ','NO2       ','m         ', &
     0.6, 9.00E-31, -1.50,     0.0, 3.00E-11,  0.00,       0.0, 0.000, 0.000) , & !   JPL2003 
ratt_t('O(3P)     ','NO2       ','NO3       ','m         ', &
     0.6, 1.30E-31, -1.50,     0.0, 2.30E-11,  0.24,       0.0, 0.000, 0.000) , & !           
ratt_t('O(3P)     ','O2        ','O3        ','m         ', &
     0.0, 5.60E-34, -2.60,     0.0, 0.00E+00,  0.00,       0.0, 0.000, 0.000) , & !   C       
ratt_t('O(1D)     ','N2        ','N2O       ','m         ', &
     0.0, 3.50E-37, -0.60,     0.0, 0.00E+00,  0.00,       0.0, 0.000, 0.000) , & !   JPL2003,
ratt_t('OH        ','NO2       ','HONO2     ','m         ', &
     0.4, 3.30E-30, -3.00,     0.0, 4.10E-11,  0.00,       0.0, 0.000, 0.000) , & !           
ratt_t('OH        ','OH        ','H2O2      ','m         ', &
     0.5, 6.90E-31, -0.80,     0.0, 2.60E-11,  0.00,       0.0, 0.000, 0.000) , & !           
ratt_t('H         ','O2        ','HO2       ','m         ', &
     0.6, 5.70E-32, -1.60,     0.0, 7.50E-11,  0.00,       0.0, 0.000, 0.000) & !  JPL2003  
  /)
  
TYPE(RATT_T), DIMENSION(  1) :: ratt_defs_strat_aer=(/                  &
ratt_t('SO2       ','OH        ','SO3       ','HO2       ', 0.6,        &
    3.00E-31, -3.30,     0.0, 1.50E-12,  0.00,       0.0, 0.000, 0.000) &
  /)
 
REAL, DIMENSION(  6,  5, ndry_strat) :: depvel_defs_strat1=RESHAPE((/ &
! O3 (Ganzeveld & Lelieveld (1995) - note 1)
  0.07,  0.07,  0.07,  0.07,  0.07,  0.07,  &
  1.00,  0.11,  0.56,  0.26,  0.11,  0.19,  &
  1.00,  0.37,  0.69,  0.59,  0.46,  0.53,  &
  0.26,  0.26,  0.26,  0.26,  0.26,  0.26,  &
  0.07,  0.07,  0.07,  0.07,  0.07,  0.07,  &
! NO (inferred from NO2 - see Giannakopoulos (1998))
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  &
  0.14,  0.01,  0.07,  0.01,  0.01,  0.01,  &
  0.10,  0.01,  0.06,  0.01,  0.01,  0.01,  &
  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  &
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  &
! NO3 (as NO2)
  0.02,  0.02,  0.02,  0.02,  0.02,  0.02,  &
  0.83,  0.04,  0.44,  0.06,  0.04,  0.05,  &
  0.63,  0.06,  0.35,  0.07,  0.06,  0.07,  &
  0.03,  0.03,  0.03,  0.03,  0.03,  0.03,  &
  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  &
! NO2 
  0.02,  0.02,  0.02,  0.02,  0.02,  0.02,  &
  0.83,  0.04,  0.44,  0.06,  0.04,  0.05,  &
  0.63,  0.06,  0.35,  0.07,  0.06,  0.07,  &
  0.03,  0.03,  0.03,  0.03,  0.03,  0.03,  &
  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  &
! N2O5 (as HNO3) 
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  4.00,  3.00,  3.50,  2.00,  1.00,  1.50,  &
  2.50,  1.50,  2.00,  1.00,  1.00,  1.00,  &
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
! HO2NO2 (as HNO3)
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  4.00,  3.00,  3.50,  2.00,  1.00,  1.50,  &
  2.50,  1.50,  2.00,  1.00,  1.00,  1.00,  &
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
! HNO3
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  4.00,  3.00,  3.50,  2.00,  1.00,  1.50,  &
  2.50,  1.50,  2.00,  1.00,  1.00,  1.00,  &
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
! H2O2
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  1.25,  0.16,  0.71,  0.28,  0.12,  0.20,  &
  1.25,  0.53,  0.89,  0.83,  0.78,  0.81,  &
  0.26,  0.26,  0.26,  0.26,  0.26,  0.26,  &
  0.32,  0.32,  0.32,  0.32,  0.32,  0.32,  &
! CO
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  &
  0.03,  0.03,  0.03,  0.03,  0.03,  0.03,  &
  0.03,  0.03,  0.03,  0.03,  0.03,  0.03,  &
  0.03,  0.03,  0.03,  0.03,  0.03,  0.03,  &
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  &
! HCHO
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  1.00,  0.01,  0.50,  0.01,  0.01,  0.01,  &
  0.71,  0.03,  0.37,  0.03,  0.03,  0.03,  &
  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  &
  0.04,  0.04,  0.04,  0.04,  0.04,  0.04,  &
! MeOOH
  0.25,  0.25,  0.25,  0.10,  0.10,  0.10,  &
  0.83,  0.04,  0.44,  0.06,  0.05,  0.06,  &
  0.63,  0.06,  0.35,  0.08,  0.06,  0.07,  &
  0.03,  0.03,  0.03,  0.03,  0.03,  0.03,  &
  0.01,  0.01,  0.01,  0.01,  0.01,  0.01,  &
! HCl (same as HBr)
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
  0.20,  0.20,  0.20,  0.20,  0.20,  0.20,  &
! HOCl (same as HOBr)
  0.20,  0.20,  0.20,  0.20,  0.20,  0.20,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
  0.20,  0.20,  0.20,  0.20,  0.20,  0.20,  &
  0.10,  0.10,  0.10,  0.10,  0.10,  0.10,  &
! HBr (note 3)
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  1.00,  1.00,  1.00,  1.00,  1.00,  1.00,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
  0.20,  0.20,  0.20,  0.20,  0.20,  0.20,  &
! HOBr (note 3)
  0.20,  0.20,  0.20,  0.20,  0.20,  0.20,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
  0.50,  0.50,  0.50,  0.50,  0.50,  0.50,  &
  0.20,  0.20,  0.20,  0.20,  0.20,  0.20,  &
  0.10,  0.10,  0.10,  0.10,  0.10,  0.10   &
  /),(/  6,  5, ndry_strat/) )

REAL, DIMENSION(  6,  5, ndry_aer) :: depvel_defs_strat_aer=RESHAPE((/ &
! SO2 (added as in ukca_chem_aer.F90)
  0.80,  0.80,  0.80,  0.80,  0.80,  0.80,  &
  0.60,  0.60,  0.60,  0.60,  0.60,  0.60,  &
  0.60,  0.60,  0.60,  0.60,  0.60,  0.60,  &
  0.60,  0.60,  0.60,  0.60,  0.60,  0.60,  &
  0.10,  0.10,  0.10,  0.10,  0.10,  0.10   &
  /),(/  6,  5, ndry_aer/) )

! The following formula is used to calculate the effective Henry's Law coef,
! which takes the affects of dissociation and complex formation on a species'
! solubility (see Giannakopoulos, 1998)
!
!       H(eff) = K(298)exp{[-deltaH/R]x[(1/T)-(1/298)]}
!
! The data in columns 1 and 2 above give the data for this gas-aqueous transfer,
!       Column 1 = K(298) [M/atm]
!       Column 2 = -deltaH/R [K-1]
!
! If the species dissociates in the aqueous phase the above term is multiplied by
! another factor of 1+{K(aq)/[H+]}, where
!       K(aq) = K(298)exp{[-deltaH/R]x[(1/T)-(1/298)]}
! The data in columns 3 and 4 give the data for this aqueous-phase dissociation,
!       Column 3 = K(298) [M]
!       Column 4 = -deltaH/R [K-1]
! The data in columns 5 and 6 give the data for a second dissociation,
! e.g for SO2, HSO3^{-}, and SO3^{2-}
!       Column 5 = K(298) [M]
!       Column 6 = -deltaH/R [K-1]


REAL, DIMENSION(  6, nwet_strat) :: henry_defs_strat1=RESHAPE((/ &
 0.6000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! NO3
 0.2100E+06, 0.8700E+04, 0.1570E+02, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! N2O5
 0.2000E+05, 0.0000E+00, 0.1000E-04, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! HO2NO2
 0.2100E+06, 0.8700E+04, 0.1570E+02, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! HONO2
 0.8300E+05, 0.7400E+04, 0.2200E-11,-0.3730E+04, 0.0000E+00, 0.0000E+00,&   ! H2O2
 0.3000E+04, 0.7200E+04, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! HCHO
 0.2000E+04, 0.5640E+04, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! MeOO
 0.3100E+03, 0.5200E+04, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! MeOOH
 0.4000E+04, 0.5900E+04, 0.1600E-04, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! HO2 
 0.0000E+05, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! BrONO2
 1.9000E+01, 6.0000E+02, 1.0000E+04, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! HCl
 9.3000E+02, 5.9000E+03, 3.2000E-08, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! HOCl
 1.3000E+00, 1.0200E+04, 1.0000E+09, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! HBr
 6.1000E+03, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! HOBr
 2.1000E+05, 8.7000E+03, 1.5700E+01, 0.0000E+00, 0.0000E+00, 0.0000E+00 &   ! ClONO2 
  /),(/  6,  nwet_strat/) )

REAL, DIMENSION(  6, nwet_aer) :: henry_defs_strat_aer=RESHAPE((/       &
 0.1130E-01, 0.2300E+04, 0.0000E+00, 0.0000E+00, 0.0000E+00, 0.0000E+00,&   ! O3
 0.1230E+01, 0.3020E+04, 0.1230E-01, 0.2010E+04, 0.6000E-07, 0.1120E+04 &   ! SO2
  /),(/  6,  nwet_aer/) )

INTERFACE ukca_init_strat
  MODULE PROCEDURE ukca_init_strat
END INTERFACE ukca_init_strat
PUBLIC ukca_init_strat

CONTAINS

SUBROUTINE UKCA_INIT_STRAT()

! To initialise chemistry files from specified species and rate arrays
! using the defined logicals. Composes chemistry definition arrays from
! components using logical definitions from RUN_UKCA namelist held in 
! UKCA module ukca_option_mod

USE yomhook,     ONLY: lhook, dr_hook
USE parkind1,    ONLY: jprb, jpim
USE ereport_mod, ONLY: ereport
IMPLICIT NONE

  INTEGER            :: ierr
  CHARACTER (LEN=72) :: cmessage

INTEGER(KIND=jpim), PARAMETER :: zhook_in  = 0
INTEGER(KIND=jpim), PARAMETER :: zhook_out = 1
REAL(KIND=jprb)               :: zhook_handle

IF (lhook) CALL dr_hook('UKCA_INIT_STRAT',zhook_in,zhook_handle)

ALLOCATE(chch_defs_strat(jpspec))
ALLOCATE(ratb_defs_strat(jpbk))
ALLOCATE(ratj_defs_strat(jppj))
ALLOCATE(ratt_defs_strat(jptk))
ALLOCATE(rath_defs_strat(jphk))
ALLOCATE(depvel_defs_strat(jddept,jddepc,jpdd))
ALLOCATE(henry_defs_strat(6,jpdw))

  IF (L_ukca_het_psc) THEN
     ALLOCATE(rath_defs_strat_chem(5))
     rath_defs_strat_chem = (/rath_defs_strat_psc/)
  ELSE
     ALLOCATE(rath_defs_strat_chem(0))
     rath_defs_strat_chem = (/rath_defs_strat_null/)
  END IF
     
 ierr = 0
 IF (L_ukca_strat) THEN
   IF (L_ukca_achem) THEN
!  Standard stratospheric chemistry with aerosol chemistry 
   IF (SIZE(chch_defs_strat_aer) /= jpspec) ierr = 1
   IF (SIZE(ratb_defs_strat1) + SIZE(ratb_defs_strat_aer) /= jpbk)      &
                   ierr = 2
   IF (SIZE(ratj_defs_strat1) + SIZE(ratj_defs_strat_aer) /= jppj)      &
                   ierr = 3
   IF (SIZE(ratt_defs_strat1) + SIZE(ratt_defs_strat_aer) /= jptk)      &
                   ierr = 4
   IF (L_ukca_het_psc) THEN
      IF (SIZE(rath_defs_strat_chem) +                                  &
           SIZE(rath_defs_strat_aer) /= jphk)                           &
                   ierr = 5
   ELSE
      IF (SIZE(rath_defs_strat_aer) /= jphk) ierr = 5
   END IF
   IF (ndry_strat + ndry_aer /= jpdd) ierr = 6
   IF (nwet_strat + nwet_aer /= jpdw) ierr = 7
   IF (ierr > 0) THEN
     cmessage = ' Size of chemical definition array incorrect'
     CALL EREPORT('UKCA_INIT_STRAT',ierr,cmessage)
   END IF
   chch_defs_strat = (/chch_defs_strat_aer/)
   ratb_defs_strat = (/ratb_defs_strat1, ratb_defs_strat_aer/)
   ratj_defs_strat = (/ratj_defs_strat1, ratj_defs_strat_aer/)
   ratt_defs_strat = (/ratt_defs_strat1, ratt_defs_strat_aer/)
   IF (L_ukca_het_psc) THEN
      rath_defs_strat = (/rath_defs_strat_chem, rath_defs_strat_aer/)
   ELSE
      rath_defs_strat = (/rath_defs_strat_aer/)
   END IF
   depvel_defs_strat(:,:,1:ndry_strat) =                                &
                              depvel_defs_strat1(:,:,1:ndry_strat)
   depvel_defs_strat(:,:,ndry_strat+1:ndry_strat+ndry_aer) =            &
                              depvel_defs_strat_aer(:,:,1:ndry_aer)
   henry_defs_strat(:,1:nwet_strat) = henry_defs_strat1(:,1:nwet_strat)
   henry_defs_strat(:,nwet_strat+1:nwet_strat+nwet_aer) =               &
                 henry_defs_strat_aer(:,1:nwet_aer)
   ELSE
! Standard stratospheric chemistry
   IF (SIZE(chch_defs_strat1) /= jpspec) ierr = 1
   IF (SIZE(ratb_defs_strat1) /= jpbk)   ierr = 2
   IF (SIZE(ratj_defs_strat1) /= jppj)   ierr = 3
   IF (SIZE(ratt_defs_strat1) /= jptk)   ierr = 4
   IF (L_ukca_het_psc) THEN
      IF (SIZE(rath_defs_strat_chem) /= jphk)   ierr = 5
   ELSE IF (jphk > 0) THEN
      ierr = 5
   END IF
   IF (ndry_strat /= jpdd) ierr = 6
   IF (nwet_strat /= jpdw) ierr = 7
   IF (ierr > 0) THEN
     cmessage = ' Size of chemical definition array incorrect'
     CALL EREPORT('UKCA_INIT_STRAT',ierr,cmessage)
   END IF
   chch_defs_strat = (/ chch_defs_strat1 /)
   ratb_defs_strat = (/ ratb_defs_strat1 /)
   ratj_defs_strat = (/ ratj_defs_strat1 /)
   ratt_defs_strat = (/ ratt_defs_strat1 /)
   rath_defs_strat = (/ rath_defs_strat_chem /)
   depvel_defs_strat = depvel_defs_strat1
   henry_defs_strat = henry_defs_strat1
   ENDIF
 ELSE
   cmessage = 'No relevant definitions to compose chemistry'
   ierr = 1
   CALL EREPORT('UKCA_INIT_STRAT',ierr,cmessage)
 ENDIF

IF (lhook) CALL dr_hook('UKCA_INIT_STRAT',zhook_out,zhook_handle)
RETURN
END SUBROUTINE UKCA_INIT_STRAT


END MODULE UKCA_CHEM_STRAT
